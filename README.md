# neural-fonts - GANì„ í™œìš©í•œ í•œê¸€ í°íŠ¸ ì œì‘ í”„ë¡œì íŠ¸

> í˜„ì¬ ì´ ì €ì¥ì†Œì˜ ì½”ë“œëŠ” ëŒ€ë¶€ë¶„ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

<p align="center">
  <img src="assets/NanumBrush-gen15.png">
</p>

GANì„ ì‚¬ìš©í•˜ì—¬ í•œê¸€ í°íŠ¸ë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ ì£¼ëŠ” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

ë””ìì´ë„ˆê°€ 399ìë§Œ ë§Œë“¤ë©´ ë”¥ëŸ¬ë‹ì„ í†µí•´ì„œ í•´ë‹¹ í°íŠ¸ì˜ style ì •ë³´ë¥¼ í›ˆë ¨í•˜ì—¬ 11,172ìì˜ ì™„ì„±í˜• í•œê¸€ì„ ìƒì„±í•©ë‹ˆë‹¤.

ì¤‘êµ­ í°íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” [zi2zi](https://github.com/kaonashi-tyc/zi2zi)ë¥¼ í•œê¸€ì— ë§ê²Œ ìˆ˜ì •í•˜ì—¬ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

## ê°¤ëŸ¬ë¦¬

### í•„ê¸°ì²´ (ë‚˜ëˆ” ë¶“ í°íŠ¸)

|             Original             |            Generated             |
| :------------------------------: | :------------------------------: |
| ![](assets/NanumBrush-org15.png) | ![](assets/NanumBrush-gen15.png) |

### ê³ ë”•ì²´ (í‘¸ë¥¸ì „ë‚¨ í°íŠ¸)

|           Original           |          Generated           |
| :--------------------------: | :--------------------------: |
| ![](assets/Pureun-org15.png) | ![](assets/Pureun-gen15.png) |

## Overview

399ìì— ëŒ€í•´ì„œë§Œ í›ˆë ¨í•  ê²½ìš° ì™„ì„±í˜• í•œê¸€ì˜ ê¸€ì ìˆ˜ì— ë¹„í•´ì„œ ì…ë ¥ í¬ê¸°ê°€ ì‘ìŠµë‹ˆë‹¤.

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë¨¼ì € ë‹¤ì–‘í•œ í•œê¸€ ê¸€ê¼´ë¡œ í›ˆë ¨í•œ ëª¨ë¸ì„ ë§Œë“­ë‹ˆë‹¤.

ìƒì„±ëœ ëª¨ë¸ì— ì „ì´ í•™ìŠµì„ í†µí•´ 399ìë¥¼ í›ˆë ¨í•˜ê³  ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸€ê¼´ì„ ìƒì„±í•©ë‹ˆë‹¤.

## ì‚¬ìš©ë²•

### ìš”êµ¬ ì‚¬í•­

- CUDA
- [cudnn](https://developer.nvidia.com/cudnn)
- poetry

### ë¯¸ë¦¬ í›ˆë ¨í•œ ëª¨ë¸ì„ ë‚´ë ¤ë°›ê±°ë‚˜ ì§ì ‘ í›ˆë ¨í•˜ê¸°

ë¨¼ì € í•œê¸€ ê¸€ê¼´ì— ëŒ€í•´ì„œ í›ˆë ¨í•œ ëª¨ë¸ì„ ìƒì„±í•©ë‹ˆë‹¤.

32ê°œì˜ copyleft ê¸€ê¼´ì— ëŒ€í•˜ì—¬ ë¯¸ë¦¬ í›ˆë ¨í•œ ëª¨ë¸ì„ ë‚´ë ¤ë°›ì•„ ì“°ê±°ë‚˜ ì›í•˜ëŠ” ê¸€ê¼´ì„ ì‚¬ìš©í•´ ì§ì ‘ í›ˆë ¨í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

> [ë¯¸ë¦¬ í›ˆë ¨í•œ ëª¨ë¸ ë‚´ë ¤ë°›ê¸°](https://mysnu-my.sharepoint.com/personal/yu65789_seoul_ac_kr/_layouts/15/guestaccess.aspx?docid=0a7fcfabb78af4958b790b98eccac135c&authkey=AVqeaI5jyQHWyklZgotc04Y) (ë§í¬ ë§Œë£Œë¨)

ìƒˆë¡œ í›ˆë ¨í•  ê²½ìš° [zi2zi](https://github.com/kaonashi-tyc/zi2zi)ì˜ READMEë¥¼ ì°¸ì¡°í•˜ì—¬ í›ˆë ¨í•˜ë©´ ë©ë‹ˆë‹¤.

### í›ˆë ¨ ë°ì´í„° ìƒì„±

ë¨¼ì € [í°íŠ¸ í…œí”Œë¦¿](template/TemplateKR.pdf)ì„ ë‚´ë ¤ë°›ì•„ì„œ ì¸ì‡„í•œ í›„, ì¹¸ì— ë§ì¶° ê¸€ì”¨ë¥¼ ì”ë‹ˆë‹¤.

ë‹¤ ì±„ìš´ í…œí”Œë¦¿ì„ ìŠ¤ìº”í•œ í›„, ì´ë¯¸ì§€ í¸ì§‘ ë„êµ¬(ê·¸ë¦¼íŒ ë“±)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ë°± ë¶€ë¶„ì„ ì˜ë¼ëƒ…ë‹ˆë‹¤.

ì˜ë¼ë‚¸ ì´ë¯¸ì§€ íŒŒì¼ì˜ ì´ë¦„ì„ í˜ì´ì§€ ìˆœì„œëŒ€ë¡œ `1-uniform.png`, `2-uniform.png`, `3-uniform.png`ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.

ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸€ê¼´ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

```sh
poetry run crop --src_dir=src_dir
                --dst_dir=dst_dir
```

`dst_dir`ì— ê° ê¸€ìì˜ ìœ ë‹ˆì½”ë“œ ê°’ì„ ì´ë¦„ìœ¼ë¡œ í•˜ëŠ” í°íŠ¸ ì´ë¯¸ì§€ íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤.

### ì „ì²˜ë¦¬

I/O ë³‘ëª©ì„ ë§‰ê¸° ìœ„í•´ì„œ ì „ì²˜ë¦¬ë¥¼ ê±°ì³ ë°”ì´ë„ˆë¦¬ë¥¼ ìƒì„±í•œ ë‹¤ìŒ ì‚¬ìš©í•©ë‹ˆë‹¤.

ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ source ê¸€ê¼´ê³¼ ì†ê¸€ì”¨ê°€ í•©ì³ì§„ í›ˆë ¨ìš© ê¸€ê¼´ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

```sh
poetry run font2img --src_font=src.ttf
                    --dst_font=src.ttf
                    --sample_count=1000
                    --sample_dir=sample_dir
                    --label=0
                    --handwriting_dir=handwriting_dir
```

`sample_dir`ì€ í›ˆë ¨ì„ ìœ„í•œ ê¸€ê¼´ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•  í´ë”ì…ë‹ˆë‹¤.
`handwriting_dir` ì˜µì…˜ì„ ì‚¬ìš©í•´ í…œí”Œë¦¿ìœ¼ë¡œ ìƒì„±í•œ í°íŠ¸ ì´ë¯¸ì§€ í´ë”ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤.
`label` ì˜µì…˜ì€ category embeddingì—ì„œì˜ font indexë¥¼ ë‚˜íƒ€ë‚´ë©° ê¸°ë³¸ê°’ì€ 0ì…ë‹ˆë‹¤. ì—¬ëŸ¬ê°œì˜ í°íŠ¸ë¥¼ í›ˆë ¨í•˜ê³  ì‹¶ì€ ê²½ìš° ê°ê°ì˜ í°íŠ¸ì— ë‹¤ë¥¸ `label`ì„ í• ë‹¹í•˜ë©´ ë©ë‹ˆë‹¤.

ì´ë¯¸ì§€ ìƒì„±ì´ ì™„ë£Œë˜ë©´ **package.py**ë¥¼ ì‹¤í–‰í•´ ì´ë¯¸ì§€ë¥¼ ë¬¶ì–´ ë°”ì´ë„ˆë¦¬ í˜•ì‹ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤.

```sh
poetry run package --fixed_sample=1
                   --dir=image_directory
                   --save_dir=binary_save_directory
```

ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ **train.obj**ê°€ `save_dir`ì— ìƒì„±ë©ë‹ˆë‹¤. í•´ë‹¹ íŒŒì¼ì´ trainingì„ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” dataì…ë‹ˆë‹¤.

### ì—°êµ¬ ë ˆì´ì•„ì›ƒ

```sh
ğŸ“‚ experiment
â””â”€â”€ ğŸ“‚ data
    â””â”€â”€ train.obj
```

ë£¨íŠ¸ í´ë” ë°‘ì— í°íŠ¸ë¥¼ ìœ„í•œ í´ë”ë¥¼ ìƒì„±í•œ ë‹¤ìŒ ì•ì—ì„œ ìƒì„±í•œ ë°”ì´ë„ˆë¦¬ íŒŒì¼ì„ `data` í´ë” ë°‘ìœ¼ë¡œ ì˜®ê¹ë‹ˆë‹¤.

### í›ˆë ¨

í›ˆë ¨ì€ ë‘ ë‹¨ê³„ë¡œ ì§„í–‰ë˜ëŠ”ë°, 1ì°¨ í›ˆë ¨ ë‹¨ê³„ê°€ ì§„í–‰ë˜ê³ , ê·¸ ë‹¤ìŒìœ¼ë¡œ íŒŒì¸ íŠœë‹ ë‹¨ê³„ê°€ ì§„í–‰ë©ë‹ˆë‹¤.

ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ í›ˆë ¨ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

#### 1ë‹¨ê³„

```sh
poetry run train --experiment_dir=experiment 
                 --experiment_id=0
                 --batch_size=16 
                 --lr=0.001
                 --epoch=30 
                 --sample_steps=100 
                 --schedule=10 
                 --L1_penalty=100 
                 --Lconst_penalty=15
```

#### 2ë‹¨ê³„

```sh
poetry run train --experiment_dir=experiment 
                 --experiment_id=0
                 --batch_size=16 
                 --lr=0.001
                 --epoch=120 
                 --sample_steps=100 
                 --schedule=40 
                 --L1_penalty=500 
                 --Lconst_penalty=1000
```

### ì¶”ë¡ 

í›ˆë ¨ì´ ëë‚œ í›„ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ ì¶”ë¡ ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

```sh
poetry run infer --model_dir=checkpoint_dir/ 
                 --batch_size=16 
                 --source_obj=binary_obj_path 
                 --embedding_ids=label[s] of the font, separate by comma
                 --save_dir=save_dir/
```

## ê°ì‚¬ì˜ ë§

- [kaonashi-tyc](https://github.com/kaonashi-tyc)ì˜ [zi2zi](https://github.com/kaonashi-tyc/zi2zi) ì €ì¥ì†Œ ì½”ë“œë¥¼ ì¬êµ¬ì„±í•´ íŒŒìƒì‹œì¼°ìŠµë‹ˆë‹¤.
- [periannath](https://github.com/periannath)ì˜ [neural-fonts](https://github.com/periannath/neural-fonts) ì €ì¥ì†Œ ì½”ë“œë¥¼ ë°”íƒ•ìœ¼ë¡œ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.

## ë¼ì´ì„ ìŠ¤

[MIT ë¼ì´ì„ ìŠ¤](LICENSE)
